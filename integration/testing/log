INFO: pid_exists | The target process exists
INFO: pid_exists | The target process exists
RUN TEST PID_EXISTS:	0

test_get_paths - /proc/14337/maps
RUN TEST GET_MAPS:	0

test_get_paths - /proc/14337/mem
RUN TEST GET_MEM:	0

test_get_paths - /proc/14337/exe
RUN TEST GET_EXE:	0

test_combined - /proc/14337/maps
test_combined - /proc/14337/mem
test_combined - /proc/14337/exe
RUN TEST COMBINED:	0

***************************************************
CHUNK 0  | Start Addr: 93862201974784     , Size: 4096   , R: 1, W: 0, P: 1, Name: /home/reskom326-lx/repos/Memory-Utils/bld/simulator (deleted) (61)
CHUNK 1  | Start Addr: 93862201978880     , Size: 4096   , R: 1, W: 0, P: 1, Name: /home/reskom326-lx/repos/Memory-Utils/bld/simulator (deleted) (61)
CHUNK 2  | Start Addr: 93862201982976     , Size: 4096   , R: 1, W: 0, P: 1, Name: /home/reskom326-lx/repos/Memory-Utils/bld/simulator (deleted) (61)
CHUNK 3  | Start Addr: 93862201987072     , Size: 4096   , R: 1, W: 0, P: 1, Name: /home/reskom326-lx/repos/Memory-Utils/bld/simulator (deleted) (61)
CHUNK 4  | Start Addr: 93862201991168     , Size: 4096   , R: 1, W: 1, P: 1, Name: /home/reskom326-lx/repos/Memory-Utils/bld/simulator (deleted) (61)
CHUNK 5  | Start Addr: 93862235504640     , Size: 135168 , R: 1, W: 1, P: 1, Name: [heap] (6)
CHUNK 6  | Start Addr: 140657938382848    , Size: 139264 , R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/libc-2.31.so (38)
CHUNK 7  | Start Addr: 140657939922944    , Size: 1540096, R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/libc-2.31.so (38)
CHUNK 8  | Start Addr: 140657940242432    , Size: 319488 , R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/libc-2.31.so (38)
CHUNK 9  | Start Addr: 140657940258816    , Size: 16384  , R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/libc-2.31.so (38)
CHUNK 10 | Start Addr: 140657940267008    , Size: 8192   , R: 1, W: 1, P: 1, Name: /usr/lib/x86_64-linux-gnu/libc-2.31.so (38)
CHUNK 11 | Start Addr: 140657940291584    , Size: 24576  , R: 1, W: 1, P: 1, Name: NULL (4)
CHUNK 12 | Start Addr: 140657940381696    , Size: 4096   , R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/ld-2.31.so (36)
CHUNK 13 | Start Addr: 140657940525056    , Size: 143360 , R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/ld-2.31.so (36)
CHUNK 14 | Start Addr: 140657940557824    , Size: 32768  , R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/ld-2.31.so (36)
CHUNK 15 | Start Addr: 140657940566016    , Size: 4096   , R: 1, W: 0, P: 1, Name: /usr/lib/x86_64-linux-gnu/ld-2.31.so (36)
CHUNK 16 | Start Addr: 140657940570112    , Size: 4096   , R: 1, W: 1, P: 1, Name: /usr/lib/x86_64-linux-gnu/ld-2.31.so (36)
CHUNK 17 | Start Addr: 140657940574208    , Size: 4096   , R: 1, W: 1, P: 1, Name: NULL (4)
CHUNK 18 | Start Addr: 140730004348928    , Size: 135168 , R: 1, W: 1, P: 1, Name: [stack] (7)
CHUNK 19 | Start Addr: 140730004623360    , Size: 16384  , R: 1, W: 0, P: 1, Name: [vvar] (6)
CHUNK 20 | Start Addr: 140730004631552    , Size: 8192   , R: 1, W: 0, P: 1, Name: [vdso] (6)
CHUNK 21 | Start Addr: 9223372036854775807, Size: 0      , R: 0, W: 0, P: 1, Name: [vsyscall] (10)
RUN TEST GET_MEM_CHNKS_ALL:	0

CHUNK 0  | Start Addr: 93862201991168     , Size: 4096   , R: 1, W: 1, P: 1, Name: /home/reskom326-lx/repos/Memory-Utils/bld/simulator (deleted) (61)
CHUNK 1  | Start Addr: 93862235504640     , Size: 135168 , R: 1, W: 1, P: 1, Name: [heap] (6)
CHUNK 2  | Start Addr: 140657940267008    , Size: 8192   , R: 1, W: 1, P: 1, Name: /usr/lib/x86_64-linux-gnu/libc-2.31.so (38)
CHUNK 3  | Start Addr: 140657940291584    , Size: 24576  , R: 1, W: 1, P: 1, Name: NULL (4)
CHUNK 4  | Start Addr: 140657940570112    , Size: 4096   , R: 1, W: 1, P: 1, Name: /usr/lib/x86_64-linux-gnu/ld-2.31.so (36)
CHUNK 5  | Start Addr: 140657940574208    , Size: 4096   , R: 1, W: 1, P: 1, Name: NULL (4)
CHUNK 6  | Start Addr: 140730004348928    , Size: 135168 , R: 1, W: 1, P: 1, Name: [stack] (7)
RUN TEST GET_MEM_CHNKS_MOD:	0

                    unsigned char int32_array[sizeof(int32_t)];
                    transform_to_bytes(2, int32, int32_array);
                    if(type_index == 2) printf("Selected value: %i\n\n", (int32_t)value);
                    else                printf("Selected value: %f\n\n", val);

                    // Perform first scan
                    Memory_T to_search = {.sz = sizeof(int32_t)};
                    to_search.data = malloc(sizeof(int32_t));
                    memcpy(to_search.data, int32_array, sizeof(int32_t));

                    int n_matches = 0;
                    long long int *matches = scan(target, &to_search, &n_matches);
                    if(n_matches == 0){
                        printf("No matches found\n");
                        break;
                    }
                    printf("%i address<es> matching the value\n", n_matches);

                    free(to_search.data);
                    bool pass = false;

                    // Wants to filter
                    if(ask_filter()){
                        bool done = false;
                        while(!done){
                            // I'm not checking everything right now. Let's hope the user is not anormaly dumb
                            printf("\nPlease, select the value to search:\n");
                            void *int32_f;
                            float val_f;
                            if(type_index == 2){
                                scanf("%ld", &value);
                                int32_f = &value;
                            } else{
                                scanf("%f", &val_f);
                                int32_f = &val_f;
                            }
                            unsigned char int32_array_f[sizeof(int32_t)];
                            transform_to_bytes(2, int32_f, int32_array_f);
                            if(type_index == 2) printf("Selected value: %i\n\n", (int32_t)value);
                            else                printf("Selected value: %f\n\n", val_f);

                            Memory_T to_search_f = {.sz = sizeof(int32_t)};
                            to_search_f.data = malloc(sizeof(int32_t));
                            memcpy(to_search_f.data, int32_array_f, sizeof(int32_t));

                            filter(target, &matches, &to_search_f, &n_matches);
                            if(n_matches == 0){
                                printf("No matches found\n");
                                pass = true;
                                break;
                            }
                            printf("%i address<es> matching the value\n", n_matches);
                            if(!ask_filter()) done = true;
                            free(to_search_f.data);
                        } if(!pass) printf("Matching address<es>:\n");
                        int k;
                        for(k = 0; k < n_matches; k++){
                            printf("Address: %#llx\n", matches[k]);
                        }
                    }
                    if(pass) break;
                    // Finally, modify the matching addresses
                    printf("\nPlease, enter the value for the new address<es>:\n");
                    void *int32_m;
                    float val_m; 
                    if(type_index == 2){
                        scanf("%ld", &value);
                        int32_m = &value;
                    } else{
                        scanf("%f", &val_m);
                        int32_m = &val_m;
                    }
                    unsigned char int32_array_m[sizeof(int32_t)];
                    transform_to_bytes(2, int32_m, int32_array_m);
                    if(type_index == 2) printf("Selected value: %i\n\n", (int32_t)value);
                    else                printf("Selected value: %f\n\n", val_m);

                    Memory_T to_search_m = {.sz = sizeof(int32_t)};
                    to_search_m.data = malloc(sizeof(int32_t));
                    memcpy(to_search_m.data, int32_array_m, sizeof(int32_t));

                    modify(target, matches, &to_search_m, n_matches);
                    printf("Value<s> modified\n\n");
                    free(to_search_m.data);
                    free(matches);
                    break;